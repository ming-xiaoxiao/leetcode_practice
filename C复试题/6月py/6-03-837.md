---
title: 837. 新21点
date: 2020-06-03 10:21:08
author: wang
toc: true
top: false
cover: false
summary: 新21点
categories: Leetcode
tags:
  - medium
  - python
---

# 837. 新21点

爱丽丝参与一个大致基于纸牌游戏 “21点” 规则的游戏，描述如下：

爱丽丝以 0 分开始，并在她的得分少于 K 分时抽取数字。 抽取时，她从 [1, W] 的范围中随机获得一个整数作为分数进行累计，其中 W 是整数。 每次抽取都是独立的，其结果具有相同的概率。

当爱丽丝获得不少于 K 分时，她就停止抽取数字。 爱丽丝的分数不超过 N 的概率是多少？





> 示例 1：
>
> 输入：N = 10, K = 1, W = 10
> 输出：1.00000
> 说明：爱丽丝得到一张卡，然后停止。
> 示例 2：
>
> 输入：N = 6, K = 1, W = 10
> 输出：0.60000
> 说明：爱丽丝得到一张卡，然后停止。
> 在 W = 10 的 6 种可能下，她的得分不超过 N = 6 分。
> 示例 3：
>
> 输入：N = 21, K = 17, W = 10
> 输出：0.73278
> 提示：
>
> 0 <= K <= N <= 10000
> 1 <= W <= 10000
> 如果答案与正确答案的误差不超过 10^-5，则该答案将被视为正确答案通过。
> 此问题的判断限制时间已经减少。
> 通过次数13,764提交次数33,425
>
> 
>
> 



## 整体分析

规则是这样：

1. 她可以从牌面为[1,W]的牌中选择任意一张，这张牌是可以无限重复的，也就是说无论她取多少次，每次取到2（假如2在[1,W]范围内）的概率都是1/W;
2. 如果她手上牌的总额小于K，她就会抽牌，大于等于K时，就停止抽牌;
3. 停止抽牌后，她的牌面小于等于N时，她就获胜了，求她获胜的概率。



## SOLUTION 1：公式

> 有点动态规划的感觉，假设`dp[x]`为她手上牌面为`x`时，能获胜的概率，那么这个概率应该是：
> `dp[x]=1/w * (dp[x+1]+dp[x+2]+dp[x+3]...+dp[x+w])`
>
> 所以我们可以倒着来，从最后一个也就是`dp[k-1]`开始计算，对于`dp[k-1]`，后面的dp数组赋值情况根据下标是否超过N，超过则赋值0也就是输掉，否则就是1赢掉

```python
class Solution:
    def new21Game(self, N: int, K: int, W: int) -> float:
        dp=[None]*(K+W)
        s=0
        # s作为区间和：dp[x+1]+dp[x+2]+dp[x+3]...+dp[x+w]
        for i in range(K,K+W):          
            dp[i] = 1 if i<=N else 0
            s+=dp[i]
        for i in range(K-1,-1,-1):      
            dp[i]=s/W
            s=s-dp[i+W]+dp[i]
        return dp[0]
```

> 执行用时 :96 ms, 在所有 Python3 提交中击败了65.19%的用户
>
> 内存消耗 :13.9 MB, 在所有 Python3 提交中击败了100.00%的用户

